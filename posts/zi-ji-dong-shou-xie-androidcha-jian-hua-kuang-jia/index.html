<!DOCTYPE html>
<html class="no-js" lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶ - Vå¤§å¸ˆåœ¨ä¸€å·çº¿</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶" />
<meta property="og:description" content="è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶ æœ€è¿‘åœ¨å·¥ä½œä¸­æ¥è§¦åˆ°äº†Androidæ’ä»¶å†…çš„å¼€å‘ï¼Œå‘ç°è‡ªå·±è¿™ç§æŠ€æœ¯è¿˜ç¼ºä¹æœ€åŸºæœ¬çš„äº†è§£ï¼Œä»¥è‡³äºåœ¨ä¸€äº›åŸºæœ¬é—®é¢˜ä¸Šæµªè´¹ä¸å°‘æ—¶é—´ï¼Œå¦‚æ’ä»¶Contextå’Œä¸»å·¥ç¨‹Contextçš„åŒº" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/zi-ji-dong-shou-xie-androidcha-jian-hua-kuang-jia/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-06-05T17:25:07+08:00" />


		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶"/>
<meta name="twitter:description" content="è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶ æœ€è¿‘åœ¨å·¥ä½œä¸­æ¥è§¦åˆ°äº†Androidæ’ä»¶å†…çš„å¼€å‘ï¼Œå‘ç°è‡ªå·±è¿™ç§æŠ€æœ¯è¿˜ç¼ºä¹æœ€åŸºæœ¬çš„äº†è§£ï¼Œä»¥è‡³äºåœ¨ä¸€äº›åŸºæœ¬é—®é¢˜ä¸Šæµªè´¹ä¸å°‘æ—¶é—´ï¼Œå¦‚æ’ä»¶Contextå’Œä¸»å·¥ç¨‹Contextçš„åŒº"/>

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/highlighter-pygments-monokai.css"><link rel="stylesheet" href="/css/asciidoctor.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="Vå¤§å¸ˆåœ¨ä¸€å·çº¿" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Vå¤§å¸ˆåœ¨ä¸€å·çº¿</div>
					<div class="logo__tagline">ä¸šç²¾äºå‹¤ï¼Œè’äºå¬‰ï¼›è¡Œæˆäºæ€ï¼Œæ¯äºéšã€‚</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">èœå•</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">é¦–é¡µ</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/categories/">
				
				<span class="menu__text">åˆ†ç±»</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">æ ‡ç­¾</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">å…³äº</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/talk/">
				
				<span class="menu__text">åˆ†äº«</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/archives/">
				
				<span class="menu__text">å½’æ¡£</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">èµµè£•(vimerzhao)</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2018-10-04T00:00:00Z">2018-10-04</time>
	<time class="meta__text" datetime="2021-06-05T17:25:07&#43;08:00">(æœ€åä¿®æ”¹: 2021-06-05)</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/android%E5%AE%9E%E8%B7%B5/" rel="category">Androidå®è·µ</a>
	</span>
</div></div>
		</header><div class="content post__content clearfix">
			<h1 id="è‡ªå·±åŠ¨æ‰‹å†™androidæ’ä»¶åŒ–æ¡†æ¶">è‡ªå·±åŠ¨æ‰‹å†™Androidæ’ä»¶åŒ–æ¡†æ¶</h1>
<p>æœ€è¿‘åœ¨å·¥ä½œä¸­æ¥è§¦åˆ°äº†Androidæ’ä»¶å†…çš„å¼€å‘ï¼Œå‘ç°è‡ªå·±è¿™ç§æŠ€æœ¯è¿˜ç¼ºä¹æœ€åŸºæœ¬çš„äº†è§£ï¼Œä»¥è‡³äºåœ¨ä¸€äº›åŸºæœ¬é—®é¢˜ä¸Šæµªè´¹ä¸å°‘æ—¶é—´ï¼Œå¦‚æ’ä»¶Contextå’Œä¸»å·¥ç¨‹Contextçš„åŒºåˆ«ï¼Œæƒé™å¿…é¡»åœ¨ä¸»å·¥ç¨‹ç”³æ˜ç­‰ï¼Œå› æ­¤èŠ±äº†ç‚¹æ—¶é—´äº†è§£äº†ä¸€ä¸‹æ’ä»¶çš„å†å²ï¼Œå¹¶å†™äº†ä¸¤ä¸ªDemoä½œä¸ºæ€»ç»“ã€‚æœ¬æ–‡æ—¨åœ¨é€šè¿‡ä¸¤ä¸ªå®ä¾‹ç›´è§‚çš„è¯´æ˜æ’ä»¶çš„å®ç°åŸç†ä»¥åŠ æ·±å¯¹æ’ä»¶å†…å¼€å‘çš„ç†è§£ï¼Œå› æ­¤ä¸ä¼šæ·±å…¥æ¢è®¨èƒŒæ™¯å’ŒåŸç†ï¼Œä»£ç ä¹Ÿå°½é‡ä¸“æ³¨äºæ ¸å¿ƒé€»è¾‘ã€‚</p>
<h2 id="åŸç†ä¸èƒŒæ™¯">åŸç†ä¸èƒŒæ™¯</h2>
<p>Androidæ’ä»¶åŒ–ä»æŠ€æœ¯ä¸Šæ¥è¯´å°±æ˜¯å¦‚ä½•å¯åŠ¨æœªå®‰è£…çš„apkï¼ˆä¸»è¦æ˜¯å››å¤§ç»„ä»¶ï¼‰é‡Œé¢çš„ç±»ï¼Œä¸»è¦é—®é¢˜æ¶‰åŠå¦‚ä½•åŠ è½½ç±»ã€å¦‚ä½•åŠ è½½èµ„æºã€å¦‚ä½•ç®¡ç†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h3 id="ç±»åŠ è½½">ç±»åŠ è½½</h3>
<p>Androidå¯¹äºå¤–éƒ¨çš„dexæ–‡ä»¶ï¼Œä¸»è¦é€šè¿‡<code>DexClassLoader</code>ç±»åŠ è½½ï¼Œå› æ­¤ï¼Œåªéœ€è¦ç»™å®šæ’ä»¶çš„è·¯å¾„ï¼Œå°±å¯ä»¥æ„é€ å¯¹åº”çš„ç±»åŠ è½½å™¨ï¼š</p>
<pre tabindex="0"><code>private DexClassLoader createDexClassLoader(String apkPath) {
    File dexOutputDir = mContext.getDir(&quot;dex&quot;, Context.MODE_PRIVATE);
    DexClassLoader loader = new DexClassLoader(apkPath, dexOutputDir.getAbsolutePath(),
            null, mContext.getClassLoader());
    return loader;
}
</code></pre><h3 id="èµ„æºåŠ è½½">èµ„æºåŠ è½½</h3>
<p>Androidç³»ç»Ÿé€šè¿‡Resourceå¯¹è±¡åŠ è½½èµ„æº,å› æ­¤åªéœ€è¦æ·»åŠ èµ„æºï¼ˆå³apkæ–‡ä»¶ï¼‰æ‰€åœ¨è·¯å¾„åˆ°<code>AssetManager</code>ä¸­ï¼Œå³å¯å®ç°å¯¹æ’ä»¶èµ„æºçš„è®¿é—®ã€‚</p>
<pre tabindex="0"><code>  AssetManager assetManager = AssetManager.class.newInstance();
  Method addAssetPath = assetManager.getClass().getMethod(addAssetPathMethod, String.class);
  addAssetPath.invoke(assetManager, apkPath);
  Resources pluginRes = new Resources(assetManager,
          mContext.getResources().getDisplayMetrics(),
          mContext.getResources().getConfiguration());
  pluginApk = new PluginApk(pluginRes);
  pluginApk.classLoader = createDexClassLoader(apkPath);
</code></pre><h3 id="ç”Ÿå‘½å‘¨æœŸ">ç”Ÿå‘½å‘¨æœŸ</h3>
<p>æ’ä»¶åŒ–ä¸­è¾ƒä¸ºå¤æ‚çš„æ˜¯å¯¹ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œå…¶ä¸­ä»¥Activityæœ€ä¸ºå¤æ‚ã€‚æ—©æœŸçš„dynamic-load-apké‡‡ç”¨çš„æ˜¯ä»£ç†çš„æ–¹å¼ï¼Œé€šè¿‡ä¸€ä¸ªç©ºå£³Activityä½œä¸ºä»£ç†ï¼ˆProxyï¼‰ï¼Œç³»ç»Ÿå¯¹è¯¥Activityçš„å›è°ƒéƒ½ä¼šæ˜ å°„åˆ°æ’ä»¶Activityï¼Œå¦‚æ­¤ä¾¿å¯ä»¥å®ç°é€šè¿‡ç³»ç»Ÿæ¥ç®¡ç†æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ç§æ–¹å¼ååˆ†ç›´è§‚ï¼Œä½†æ˜¯éœ€è¦æ‰€æœ‰çš„æ’ä»¶Activityéƒ½ç»§æ‰¿è¿™ä¸ªç”¨ä½œä»£ç†çš„<code>PluginActivity</code>ï¼ˆDemoä¸­çš„å‘½åï¼‰ï¼Œä¾µå…¥æ€§å¼ºï¼Œå¯ç»“åˆåé¢çš„ä¾‹å­åŠ æ·±ç†è§£ã€‚å› æ­¤ï¼Œå¦‚ä½•é¿å…è¿™ç§ä¾µå…¥æ€§æˆäº†ç¬¬äºŒä»£æ’ä»¶åŒ–æ¡†æ¶çš„ç›®æ ‡ï¼ŒVirtualApké€šè¿‡Hookå°‘é‡ç³»ç»Ÿç±»è¾¾åˆ°äº†è¿™ä¸ªç›®æ ‡ï¼Œæ’ä»¶çš„å¼€å‘å’Œæ™®é€šå·¥ç¨‹æ— å¼‚ï¼Œæ¥å…¥æˆæœ¬æä½ã€‚
äº†è§£äº†è¿™äº›åŸç†å¾€å¾€è¿˜ä¸å¤Ÿï¼ŒçŸ¥è¯†å¾€å¾€éœ€è¦ç»è¿‡æ¨å¯¼å’Œå®è·µæ‰èƒ½å˜æˆè‡ªå·±çš„ï¼Œå› æ­¤ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç»“åˆè¿™äº›åŸç†æ¥å®ç°ä¸€ä¸ªæ’ä»¶åŒ–æ¡†æ¶ï¼Œä¸è€ƒè™‘å…¼å®¹æ€§å’Œå¥å£®æ€§ï¼Œçº¯ç²¹æ¥å®è·µä¸Šé¢æåŠçš„åŸç†ã€‚</p>
<h2 id="ä»£ç†å®ç°">ä»£ç†å®ç°</h2>
<p>é¦–å…ˆå»ºç«‹ä¸€ä¸ª<code>PluginManager</code>ç±»æ¥å®ç°æ’ä»¶çš„åŠ è½½ï¼š</p>
<pre tabindex="0"><code>public class PluginManager {
    static class PluginMgrHolder {
        static PluginManager sManager = new PluginManager();
    }

    private static Context mContext;

    Map&lt;String, PluginApk&gt; sMap = new HashMap&lt;&gt;();

    public static PluginManager getInstance() {
        return PluginMgrHolder.sManager;
    }
    public PluginApk getPluginApk(String packageName) {
        return sMap.get(packageName);
    }

    public static void init(Context context) {
        mContext = context.getApplicationContext();
    }

    public final void loadApk(String apkPath) {
        PackageInfo packageInfo = queryPackageInfo(apkPath);
        if (packageInfo == null || TextUtils.isEmpty(packageInfo.packageName)) {
            return;
        }
        // check cache
        PluginApk pluginApk = sMap.get(packageInfo.packageName);

        if (pluginApk == null) {
            pluginApk = createApk(apkPath);
            if (pluginApk != null) {
                pluginApk.packageInfo = packageInfo;
                sMap.put(packageInfo.packageName, pluginApk);
            } else {
                throw new NullPointerException(&quot;PluginApk is null&quot;);
            }
        }
    }

    private PluginApk createApk(String apkPath) {
        String addAssetPathMethod = &quot;addAssetPath&quot;;
        PluginApk pluginApk = null;
        try {
            AssetManager assetManager = AssetManager.class.newInstance();
            Method addAssetPath = assetManager.getClass().getMethod(addAssetPathMethod, String.class);
            addAssetPath.invoke(assetManager, apkPath);
            Resources pluginRes = new Resources(assetManager,
                    mContext.getResources().getDisplayMetrics(),
                    mContext.getResources().getConfiguration());
            pluginApk = new PluginApk(pluginRes);
            pluginApk.classLoader = createDexClassLoader(apkPath);
        } catch (IllegalAccessException
                | InstantiationException
                | NoSuchMethodException
                | InvocationTargetException e) {
            e.printStackTrace();
        }
        return pluginApk;
    }
    private PackageInfo queryPackageInfo(String apkPath) {
        PackageInfo packageInfo = mContext.getPackageManager().getPackageArchiveInfo(apkPath,
                PackageManager.GET_ACTIVITIES | PackageManager.GET_SERVICES);
        if (packageInfo == null) {
            return null;
        }
        return packageInfo;
    }

    private DexClassLoader createDexClassLoader(String apkPath) {
        File dexOutputDir = mContext.getDir(&quot;dex&quot;, Context.MODE_PRIVATE);
        DexClassLoader loader = new DexClassLoader(apkPath, dexOutputDir.getAbsolutePath(),
                null, mContext.getClassLoader());
        return loader;
    }

    public void startActivity(Intent intent) {
        Intent pluginIntent = new Intent(mContext, ProxyActivity.class);
        Bundle extra = intent.getExtras();
        // complicate if statement
        if (extra == null || !extra.containsKey(Constants.PLUGIN_CLASS_NAME) &amp;&amp; !extra.containsKey(Constants.PACKAGE_NAME)) {
            try {
                throw new IllegalAccessException(&quot;lack class of plugin and package name&quot;);
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            }
        }
        pluginIntent.putExtras(intent);
        pluginIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        mContext.startActivity(pluginIntent);
    }
}

</code></pre><p><code>PluginApk</code>è¡¨ç¤ºä¸€ä¸ªApkæ–‡ä»¶ï¼š</p>
<pre tabindex="0"><code>public class PluginApk {
    public PackageInfo packageInfo;
    public DexClassLoader classLoader;
    public Resources pluginRes;

    public PluginApk(Resources pluginRes) {
        this.pluginRes = pluginRes;
    }

}
</code></pre><p>æ‰€æœ‰æ’ä»¶Activityéƒ½è¦ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»<code>PluginActivity</code>:</p>
<pre tabindex="0"><code>public abstract class PluginActivity extends Activity implements Pluginable, Attachable&lt;Activity&gt; {
    public final static String TAG = PluginActivity.class.getSimpleName();
    protected Activity mProxyActivity;
    private Resources mResources;
    PluginApk mPluginApk;

    @Override
    public void attach(Activity proxy, PluginApk apk) {
        mProxyActivity = proxy;
        mPluginApk = apk;
        mResources = apk.pluginRes;
    }

    @Override
    public void setContentView(int layoutResID) {
        mProxyActivity.setContentView(layoutResID);
    }

    @Override
    public void setContentView(View view) {
        mProxyActivity.setContentView(view);
    }

    @Override
    public void setContentView(View view, ViewGroup.LayoutParams params) {
        mProxyActivity.setContentView(view, params);
    }


    @Override
    public View findViewById(int id) {
        return mProxyActivity.findViewById(id);
    }

    @Override
    public Resources getResources() {
        return mResources;
    }

    @Override
    public WindowManager getWindowManager() {
        return mProxyActivity.getWindowManager();
    }

    @Override
    public ClassLoader getClassLoader() {
        return mProxyActivity.getClassLoader();
    }

    @Override
    public Context getApplicationContext() {
        return mProxyActivity.getApplicationContext();
    }

    @Override
    public MenuInflater getMenuInflater() {
        return mProxyActivity.getMenuInflater();
    }


    @Override
    public Window getWindow() {
        return mProxyActivity.getWindow();
    }

    @Override
    public Intent getIntent() {
        return mProxyActivity.getIntent();
    }

    @Override
    public LayoutInflater getLayoutInflater() {
        return mProxyActivity.getLayoutInflater();
    }

    @Override
    public String getPackageName() {
        return mPluginApk.packageInfo.packageName;
    }


    @Override
    public void onCreate(Bundle bundle) {
        // DO NOT CALL super.onCreate(bundle)
        // following same
        VLog.log(TAG + &quot;: onCreate&quot;);
    }

    @Override
    public void onStart() {

    }

    @Override
    public void onResume() {

    }

    @Override
    public void onStop() {

    }

    @Override
    public void onPause() {

    }

    @Override
    public void onDestroy() {
    }
}

</code></pre><p>è¿™ä¸ªç±»åªæ˜¯ä¸€ä¸ªå£³ï¼Œç³»ç»Ÿä¼šé€šè¿‡<code>ProxyActivity</code>è§¦å‘å¯¹åº”çš„æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p>
<pre tabindex="0"><code>public class ProxyActivity extends Activity {
    LifeCircleController mPluginController = new LifeCircleController(this);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mPluginController.onCreate(getIntent().getExtras());
    }

    @Override
    public Resources getResources() {
        // construct when loading apk
        Resources resources = mPluginController.getResources();
        return resources == null ? super.getResources() : resources;
    }

    @Override
    public Resources.Theme getTheme() {
        Resources.Theme theme = mPluginController.getTheme();
        return theme == null ? super.getTheme() : theme;
    }

    @Override
    public AssetManager getAssets() {
        return mPluginController.getAssets();
    }


    @Override
    protected void onStart() {
        super.onStart();
        mPluginController.onStart();
    }

    @Override
    protected void onResume() {
        super.onResume();
        mPluginController.onResume();
    }

    @Override
    protected void onStop() {
        super.onStop();
        mPluginController.onStop();
    }

    @Override
    protected void onPause() {
        super.onPause();
        mPluginController.onPause();
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        mPluginController.onDestroy();
    }
}
</code></pre><p>è¿™ä¸ªç±»æ˜¯ç³»ç»Ÿå®é™…å¯åŠ¨çš„ç±»ï¼Œå…¶ä¸»è¦é€»è¾‘ç”±<code>LifeCircleController</code>è´Ÿè´£ï¼š</p>
<pre tabindex="0"><code>public class LifeCircleController implements Pluginable {
    Activity mProxy;
    PluginActivity mPlugin;
    Resources mResources;
    Resources.Theme mTheme;
    PluginApk mPluginApk;
    String mPluginClazz;

    public LifeCircleController(Activity activity) {
        mProxy = activity;
    }

    public void onCreate(Bundle bundle) {
        mPluginClazz = bundle.getString(Constants.PLUGIN_CLASS_NAME);
        String packageName = bundle.getString(Constants.PACKAGE_NAME);
        mPluginApk = PluginManager.getInstance().getPluginApk(packageName);
        try {
            mPlugin = (PluginActivity) loadPluginable(mPluginApk.classLoader, mPluginClazz);
            mPlugin.attach(mProxy, mPluginApk);
            mResources = mPluginApk.pluginRes;
            mPlugin.onCreate(bundle);
        } catch (Exception e) {
            VLog.log(&quot;Fail in LifeCircleController onCreate&quot;);
            VLog.log(e.getMessage());
            e.printStackTrace();
        }

    }
    private Object loadPluginable(ClassLoader classLoader, String pluginActivityClass)
            throws Exception {
        Class&lt;?&gt; pluginClz = classLoader.loadClass(pluginActivityClass);
        Constructor&lt;?&gt; constructor = pluginClz.getConstructor(new Class[] {});
        constructor.setAccessible(true);
        return constructor.newInstance(new Object[] {});
    }

    @Override
    public void onStart() {
        if (mPlugin != null) {
            mPlugin.onStart();
        }
    }

    @Override
    public void onResume() {
        if (mPlugin != null) {
            mPlugin.onResume();
        }
    }

    @Override
    public void onStop() {
        mPlugin.onStop();
    }

    @Override
    public void onPause() {
        mPlugin.onPause();
    }

    @Override
    public void onDestroy() {
        mPlugin.onDestroy();
    }

    public Resources getResources() {
        return mResources;
    }

    public Resources.Theme getTheme() {
        return mTheme;
    }

    public AssetManager getAssets() {
        return mResources.getAssets();
    }

}

</code></pre><p>æœ‰ç‚¹åƒActivityæºç çš„å¤–è§‚æ¨¡å¼ï¼Œå†…éƒ¨çš„åˆ†å·¥å’ŒèŒè´£åˆ’åˆ†å¯¹äºä½¿ç”¨è€…æ˜¯ä¸å¯è§çš„ã€‚
æœ€ååœ¨ä¸»å·¥ç¨‹å¯åŠ¨æ’ä»¶ï¼š</p>
<pre tabindex="0"><code>Intent intent = new Intent();
intent.putExtra(Constants.PACKAGE_NAME, PLUGIN_PACKAGE_NAME);
intent.putExtra(Constants.PLUGIN_CLASS_NAME, PLUGIN_CLAZZ_NAME);
mPluginManager.startActivity(intent);
</code></pre><p>æ’ä»¶Activityå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public class MainActivity extends PluginActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        setTitle(&quot;Plugin App&quot;);
        ((ImageView) findViewById(R.id.iv_logo)).setImageResource(R.drawable.android);
    }
}
</code></pre><p>æ•ˆæœï¼š
<img src="http://ond7j4cnz.bkt.clouddn.com/plugin_demo.gif" alt=""></p>
<h2 id="hookå®ç°">Hookå®ç°</h2>
<p>Hookçš„æ–¹å¼éœ€è¦åŸºæœ¬äº†è§£ç³»ç»Ÿå¯åŠ¨ä¸€ä¸ªActivityçš„è¿‡ç¨‹ï¼Œä¸€èˆ¬æ¥è¯´ç³»ç»Ÿä¼šå…ˆæ£€æŸ¥Activityæ˜¯å¦æ³¨å†Œï¼Œç„¶åå†å»ç”Ÿæˆè¯¥Activityï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨æ£€æŸ¥çš„æ—¶å€™ç”¨ä¸€ä¸ªå·²ç»æ³¨å†Œçš„Activityï¼ˆæ¡©ï¼Œé€šå¸¸è¡¨ç¤ºä¸ºStubActivityï¼‰æ¥ç»™ç³»ç»Ÿæ£€æŸ¥ï¼Œæ£€æŸ¥é€šè¿‡ååœ¨ç”Ÿæˆçš„æ—¶å€™å†æ›¿æ¢æˆæ’ä»¶çš„å°±å¯ä»¥äº†ã€‚
é¦–å…ˆè¦è‡ªå·±å®ç°ä¸€ä¸ª<code>Instrumentation</code>ï¼Œåœ¨é‡Œé¢åšä¸€äº›æ›¿æ¢å·¥ä½œï¼Œç„¶åå»Hookæ‰ç³»ç»ŸæŒæœ‰çš„å¯¹è±¡ï¼š</p>
<pre tabindex="0"><code>public class HookedInstrumentation extends Instrumentation implements Handler.Callback {
    public static final String TAG = &quot;HookedInstrumentation&quot;;
    protected Instrumentation mBase;
    private PluginManager mPluginManager;

    public HookedInstrumentation(Instrumentation base, PluginManager pluginManager) {
        mBase = base;
        mPluginManager = pluginManager;
    }

    /**
     * è¦†ç›–æ‰åŸå§‹Instrumentationç±»çš„å¯¹åº”æ–¹æ³•,ç”¨äºæ’ä»¶å†…éƒ¨è·³è½¬Activityæ—¶é€‚é…
     *
     * @Override
     */
    public ActivityResult execStartActivity(
            Context who, IBinder contextThread, IBinder token, Activity target,
            Intent intent, int requestCode, Bundle options) {

        if (Constants.DEBUG) Log.e(TAG, &quot;execStartActivity&quot;);
        mPluginManager.hookToStubActivity(intent);

        try {
            Method execStartActivity = Instrumentation.class.getDeclaredMethod(
                    &quot;execStartActivity&quot;, Context.class, IBinder.class, IBinder.class,
                    Activity.class, Intent.class, int.class, Bundle.class);
            execStartActivity.setAccessible(true);
            return (ActivityResult) execStartActivity.invoke(mBase, who,
                    contextThread, token, target, intent, requestCode, options);
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(&quot;do not support!!!&quot; + e.getMessage());
        }
    }

    @Override
    public Activity newActivity(ClassLoader cl, String className, Intent intent) throws InstantiationException, IllegalAccessException, ClassNotFoundException {
        if (Constants.DEBUG) Log.e(TAG, &quot;newActivity&quot;);

        if (mPluginManager.hookToPluginActivity(intent)) {
            String targetClassName = intent.getComponent().getClassName();
            PluginApp pluginApp = mPluginManager.getLoadedPluginApk();
            Activity activity = mBase.newActivity(pluginApp.mClassLoader, targetClassName, intent);
            activity.setIntent(intent);
            ReflectUtil.setField(ContextThemeWrapper.class, activity, Constants.FIELD_RESOURCES, pluginApp.mResources);
            return activity;
        }

        if (Constants.DEBUG) Log.e(TAG, &quot;super.newActivity(...)&quot;);
        return super.newActivity(cl, className, intent);
    }

    @Override
    public boolean handleMessage(Message message) {
        if (Constants.DEBUG) Log.e(TAG, &quot;handleMessage&quot;);
        return false;
    }


    @Override
    public void callActivityOnCreate(Activity activity, Bundle icicle) {
        if (Constants.DEBUG) Log.e(TAG, &quot;callActivityOnCreate&quot;);
        super.callActivityOnCreate(activity, icicle);
    }
}

</code></pre><p>åœ¨è´Ÿè´£å¯åŠ¨çš„<code>execStartActivity</code>è®¾ç½®ä¸ºå¯åŠ¨å·²æ³¨å†Œçš„Activityï¼Œå†åœ¨<code>newActivity</code>è®¾ç½®ä¸ºå®é™…è¦å¯åŠ¨çš„æ’ä»¶çš„Activityã€‚ç„¶åå»Hookç³»ç»ŸæŒæœ‰çš„è¯¥å­—æ®µï¼š</p>
<pre tabindex="0"><code>public class ReflectUtil {
    public static final String METHOD_currentActivityThread = &quot;currentActivityThread&quot;;
    public static final String CLASS_ActivityThread = &quot;android.app.ActivityThread&quot;;
    public static final String FIELD_mInstrumentation = &quot;mInstrumentation&quot;;
    public static final String TAG = &quot;ReflectUtil&quot;;


    private static Instrumentation sInstrumentation;
    private static Instrumentation sActivityInstrumentation;
    private static Field sActivityThreadInstrumentationField;
    private static Field sActivityInstrumentationField;
    private static Object sActivityThread;

    public static boolean init() {
        //è·å–å½“å‰çš„ActivityThreadå¯¹è±¡
        Class&lt;?&gt; activityThreadClass = null;
        try {
            activityThreadClass = Class.forName(CLASS_ActivityThread);
            Method currentActivityThreadMethod = activityThreadClass.getDeclaredMethod(METHOD_currentActivityThread);
            currentActivityThreadMethod.setAccessible(true);
            Object currentActivityThread = currentActivityThreadMethod.invoke(null);


            //æ‹¿åˆ°åœ¨ActivityThreadç±»é‡Œé¢çš„åŸå§‹mInstrumentationå¯¹è±¡
            Field instrumentationField = activityThreadClass.getDeclaredField(FIELD_mInstrumentation);
            instrumentationField.setAccessible(true);
            sActivityThreadInstrumentationField = instrumentationField;

            sInstrumentation = (Instrumentation) instrumentationField.get(currentActivityThread);
            sActivityThread = currentActivityThread;


            sActivityInstrumentationField =  Activity.class.getDeclaredField(FIELD_mInstrumentation);
            sActivityInstrumentationField.setAccessible(true);
            return true;
        } catch (ClassNotFoundException
                | NoSuchMethodException
                | IllegalAccessException
                | InvocationTargetException
                | NoSuchFieldException e) {
            e.printStackTrace();
        }

        return false;
    }

    public static Instrumentation getInstrumentation() {
        return sInstrumentation;
    }

    public static Object getActivityThread() {
        return sActivityThread;
    }

    public static void setInstrumentation(Object activityThread, HookedInstrumentation hookedInstrumentation) {
        try {
            sActivityThreadInstrumentationField.set(activityThread, hookedInstrumentation);
            if (Constants.DEBUG) Log.e(TAG, &quot;set hooked instrumentation&quot;);
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }

    public static void setActivityInstrumentation(Activity activity, PluginManager manager) {
        try {
            sActivityInstrumentation = (Instrumentation) sActivityInstrumentationField.get(activity);
            HookedInstrumentation instrumentation = new HookedInstrumentation(sActivityInstrumentation, manager);
            sActivityInstrumentationField.set(activity, instrumentation);
            if (Constants.DEBUG) Log.e(TAG, &quot;set activity hooked instrumentation&quot;);
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }


    public static void setField(Class clazz, Object target, String field, Object object) {
        try {
            Field f = clazz.getDeclaredField(field);
            f.setAccessible(true);
            f.set(target, object);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

}

</code></pre><p><code>PluginManager</code>åŒæ ·è´Ÿè´£åŠ è½½æ’ä»¶çš„ç±»å’Œèµ„æºç­‰ï¼š</p>
<pre tabindex="0"><code>public class PluginManager {
    private final static String TAG = &quot;PluginManager&quot;;
    private static PluginManager sInstance;
    private Context mContext;
    private PluginApp mPluginApp;


    public static PluginManager getInstance(Context context) {
        if (sInstance == null &amp;&amp; context != null) {
            sInstance = new PluginManager(context);
        }
        return sInstance;
    }

    private PluginManager(Context context) {
        mContext = context;
    }


    public void hookInstrumentation() {
        try {
            Instrumentation baseInstrumentation = ReflectUtil.getInstrumentation();

            final HookedInstrumentation instrumentation = new HookedInstrumentation(baseInstrumentation, this);

            Object activityThread = ReflectUtil.getActivityThread();
            ReflectUtil.setInstrumentation(activityThread, instrumentation);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void hookCurrentActivityInstrumentation(Activity activity) {
        ReflectUtil.setActivityInstrumentation(activity, sInstance);
    }


    public void hookToStubActivity(Intent intent) {
        if (Constants.DEBUG) Log.e(TAG, &quot;hookToStubActivity&quot;);

        if (intent == null || intent.getComponent() == null) {
            return;
        }
        String targetPackageName = intent.getComponent().getPackageName();
        String targetClassName = intent.getComponent().getClassName();

        if (mContext != null
                &amp;&amp; !mContext.getPackageName().equals(targetPackageName)
                &amp;&amp; isPluginLoaded(targetPackageName)) {
            if (Constants.DEBUG) Log.e(TAG, &quot;hook &quot; +  targetClassName + &quot; to &quot; + Constants.STUB_ACTIVITY);

            intent.setClassName(Constants.STUB_PACKAGE, Constants.STUB_ACTIVITY);
            intent.putExtra(Constants.KEY_IS_PLUGIN, true);
            intent.putExtra(Constants.KEY_PACKAGE, targetPackageName);
            intent.putExtra(Constants.KEY_ACTIVITY, targetClassName);
        }
    }

    public boolean hookToPluginActivity(Intent intent) {
        if (Constants.DEBUG) Log.e(TAG, &quot;hookToPluginActivity&quot;);
        if (intent.getBooleanExtra(Constants.KEY_IS_PLUGIN, false)) {
            String pkg = intent.getStringExtra(Constants.KEY_PACKAGE);
            String activity = intent.getStringExtra(Constants.KEY_ACTIVITY);
            if (Constants.DEBUG) Log.e(TAG, &quot;hook &quot; + intent.getComponent().getClassName() + &quot; to &quot; + activity);
            intent.setClassName(pkg, activity);
            return true;
        }
        return false;
    }

    private boolean isPluginLoaded(String packageName) {
        // TODO æ£€æŸ¥packageNmaeæ˜¯å¦åŒ¹é…
        return mPluginApp != null;
    }



    public PluginApp loadPluginApk(String apkPath) {
        String addAssetPathMethod = &quot;addAssetPath&quot;;
        PluginApp pluginApp = null;
        try {
            AssetManager assetManager = AssetManager.class.newInstance();
            Method addAssetPath = assetManager.getClass().getMethod(addAssetPathMethod, String.class);
            addAssetPath.invoke(assetManager, apkPath);
            Resources pluginRes = new Resources(assetManager,
                    mContext.getResources().getDisplayMetrics(),
                    mContext.getResources().getConfiguration());
            pluginApp = new PluginApp(pluginRes);
            pluginApp.mClassLoader = createDexClassLoader(apkPath);
        } catch (IllegalAccessException
                | InstantiationException
                | NoSuchMethodException
                | InvocationTargetException e) {
            e.printStackTrace();
        }
        return pluginApp;
    }

    private DexClassLoader createDexClassLoader(String apkPath) {
        File dexOutputDir = mContext.getDir(&quot;dex&quot;, Context.MODE_PRIVATE);
        return new DexClassLoader(apkPath, dexOutputDir.getAbsolutePath(),
                null, mContext.getClassLoader());

    }

    public boolean loadPlugin(String apkPath) {
        File apk = new File(apkPath);
        if (!apk.exists()) {
            return false;
        }
        mPluginApp = loadPluginApk(apkPath);
        return mPluginApp != null;
    }

    public PluginApp getLoadedPluginApk() {
        return mPluginApp;
    }
}
</code></pre><p>åœ¨MainActivityä¸­åˆå§‹åŒ–ï¼Œæ³¨æ„Hookçš„æ—¶æœºï¼š</p>
<pre tabindex="0"><code>public class MainActivity extends Activity implements View.OnClickListener {
    // https://zhuanlan.zhihu.com/p/33017826

    public static final boolean DEBUG = true;
    public static final String TAG = &quot;MainActivity&quot;;

    private String mPluginPackageName = &quot;top.vimerzhao.image&quot;;
    private String mPluginClassName = &quot;top.vimerzhao.image.MainActivity&quot;;

    //è¯»å†™æƒé™
    private static String[] PERMISSIONS_STORAGE = {Manifest.permission.READ_EXTERNAL_STORAGE,
            Manifest.permission.WRITE_EXTERNAL_STORAGE};
    //è¯·æ±‚çŠ¶æ€ç 
    private static int REQUEST_PERMISSION_CODE = 1;

    private PluginManager mPluginManager;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        initData();
        initView();
        initPlugin();
    }


    private void initPlugin() {
        // !! must first
        ReflectUtil.init();

        mPluginManager = PluginManager.getInstance(getApplicationContext());
        mPluginManager.hookInstrumentation();
        mPluginManager.hookCurrentActivityInstrumentation(this);
    }

    private void initData() {
        if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.LOLLIPOP) {
            if (ActivityCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
                ActivityCompat.requestPermissions(this, PERMISSIONS_STORAGE, REQUEST_PERMISSION_CODE);
            }
        }
    }

    private void initView() {
        (findViewById(R.id.tv_launch)).setOnClickListener(this);
    }

    @Override
    protected void attachBaseContext(Context newBase) {
        super.attachBaseContext(newBase);
        // !!! ä¸è¦åœ¨æ­¤Hook,çœ‹æºç å‘ç°mInstrumentaionä¼šåœ¨æ­¤æ–¹æ³•ååˆå§‹åŒ–
    }

    @Override
    public void onClick(View view) {
        if (Constants.DEBUG) Log.e(TAG, &quot;click view id: &quot; + view.getId());
        if (view.getId() == R.id.tv_launch) {
            // TODO launch plugin app
            if (mPluginManager.loadPlugin(Constants.PLUGIN_PATH)) {
                Intent intent = new Intent();
                intent.setClassName(mPluginPackageName, mPluginClassName);
                startActivity(intent);
            }
        }

    }
}
</code></pre><p>ç°åœ¨æ’ä»¶Activityä¸ä¼šæœ‰ä»»ä½•é™åˆ¶ï¼š</p>
<pre tabindex="0"><code>public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    }

    @Override
    protected void onResume() {
        super.onResume();

    }
}
</code></pre><p>æ•ˆæœå’Œä¸Šå›¾ç±»ä¼¼ã€‚</p>
<h2 id="demoåœ°å€">Demoåœ°å€</h2>
<p>éƒ¨åˆ†æºç æ— å…³æ ¸å¿ƒé€»è¾‘ï¼Œæ²¡æœ‰ç»™åˆ°ï¼Œç›®å½•ç»“æ„ä¹Ÿæ²¡æœ‰è¯´æ˜ï¼Œè¯¦è§Demoæºç ã€‚
<a href="https://github.com/vimerzhao/PluginDemo">PluginDemo</a></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>çœ‹ç€ç†è®ºæ„Ÿè§‰ä¼¼æ‡‚éæ‡‚ï¼Œå®æˆ˜å‘ç°é—®é¢˜å…¶å®æŒºå¤šçš„ï¼Œå°¤å…¶æ˜¯Hookçš„æ—¶æœºï¼Œç…§æ¬ç½‘ä¸Šçš„æ–‡ç« å‘ç°æ ¹æœ¬ä¸å¯è¡Œã€‚æ’ä»¶åŒ–ä¹Ÿä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè€Œæ˜¯åœ¨å·²æœ‰æˆæœçš„åŸºç¡€ä¸Šä¸€æ¬¡ä¸€æ¬¡çš„å°åˆ›æ–°ç§¯ç´¯èµ·æ¥çš„ï¼Œè·Ÿç€æ’ä»¶åŒ–å‘å±•çš„è·¯å¾„è‡ªå·±åŠ¨æ‰‹å®è·µä¸€éè¿˜æ˜¯èƒ½å‘ç°å¾ˆå¤šè‡ªå·±ç†è§£ä¸å¤Ÿæ·±åˆ»çš„åœ°æ–¹çš„ã€‚
ä»¥ä¸Šã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li>ã€ŠAndroidæºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹</li>
<li><a href="https://zhuanlan.zhihu.com/p/33017826">æ·±å…¥ç†è§£Androidæ’ä»¶åŒ–æŠ€æœ¯</a></li>
</ul>

		</div>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="èµµè£•(vimerzhao) avatar" src="/images/avatar.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">å…³äº èµµè£•(vimerzhao)</span>
	</div>
	<div class="authorbox__description">
		ğŸ‘ˆæ¬¢è¿æ‰«ç å…³æ³¨ï¼šä¸€ä¸ªç¨‹åºå‘˜å¯¹äºæŠ€æœ¯ã€èŒåœºã€æˆé•¿çš„æ€è€ƒï¼Œä»¥åŠè¯»ä¹¦ã€çœ‹å‰§ã€æ—…æ¸¸çš„ç¢ç¢å¿µã€‚
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/yuan-ma-yue-du-huan-jing-opengrokda-jian/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;ä¸Šä¸€ç¯‡</span>
			<p class="pager__title">æºç é˜…è¯»ç¯å¢ƒOpenGrokæ­å»º</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/xiao-cheng-xu-yun-kai-fa-shi-zhan-yi-tian-da-jian-xiao-xing-lun-tan/" rel="next">
			<span class="pager__subtitle">ä¸‹ä¸€ç¯‡&thinsp;Â»</span>
			<p class="pager__title">ã€å°ç¨‹åº&#43;äº‘å¼€å‘ã€‘å®æˆ˜ï¼šä¸€å¤©æ­å»ºå°å‹è®ºå›</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="æœç´¢â€¦" value="" name="q" aria-label="æœç´¢â€¦">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="/" />
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">è¿‘æœŸæ–‡ç« </h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/research-about-note-software/">å…³äºç¬”è®°è½¯ä»¶çš„æ¯”è¾ƒç ”ç©¶</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/change-input-method-with-left-shift/">å®šåˆ¶Macçš„è¾“å…¥æ³•åˆ‡æ¢æŒ‰é”®ä¸ºå·¦Shift</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/developing-cpp-with-android-sutdio/">Android Sutdioå¼€å‘C&#43;&#43;é¡¹ç›®è¸©å‘è®°å½•</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">åˆ†ç±»</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/android%E5%AE%9E%E8%B7%B5/">Androidå®è·µ</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">19</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/bug%E8%A7%A3%E5%86%B3%E8%AE%B0%E5%BD%95/">Bugè§£å†³è®°å½•</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">13</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/flutter%E5%AE%9E%E8%B7%B5/">Flutterå®è·µ</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">4</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E4%B8%9A%E4%BD%99%E7%A0%94%E7%A9%B6/">ä¸šä½™ç ”ç©¶</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">5</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%8E%86%E5%8F%B2%E5%BD%92%E6%A1%A3/">å†å²å½’æ¡£</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">38</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%80%BB%E7%BB%93%E5%8F%8D%E6%80%9D/">æ€»ç»“åæ€</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">7</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%8A%98%E8%85%BE%E5%B7%A5%E5%85%B7/">æŠ˜è…¾å·¥å…·</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">29</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/">æºç å‰–æ</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">11</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">è¯»ä¹¦ç¬”è®°</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">13</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B2%89%E6%80%9D%E5%BD%95/">è½¯ä»¶æ²‰æ€å½•</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">4</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E9%9A%8F%E7%AC%94%E6%9D%82%E8%AE%B0/">éšç¬”æ‚è®°</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">17</span>
				</li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">æ ‡ç­¾</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%8A%80%E6%9C%AF%E7%B2%BE%E9%80%89/" title="æŠ€æœ¯ç²¾é€‰">æŠ€æœ¯ç²¾é€‰ (7)</a>
	</div>
</div>
<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">ç¤¾äº¤</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="GitHub" rel="noopener noreferrer" href="https://github.com/vimerzhao" target="_blank">
				<svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0c-106.1 0-192 85.8-192 191.7 0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2 0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8 0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7 0 0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4 0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5 0 25.6-.2 46.3-.2 52.6 0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg>
				<span>GitHub</span>
			</a>
		</div>

		
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 Vå¤§å¸ˆåœ¨ä¸€å·çº¿.
			<span class="footer__copyright-credits">åŸºäº <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> å¼•æ“å’Œ <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> ä¸»é¢˜</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>